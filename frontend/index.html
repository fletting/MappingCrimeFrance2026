<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>MAPPINGCRIME France – Carte citoyenne</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <!-- Styles de l'application -->
  <link rel="stylesheet" href="css/style.css" />
</head>
<body class="app">
  <!-- BARRE DU HAUT -->
  <header class="topbar">
    <div class="topbar-left">
      <span class="logo">MC</span>
      <div class="topbar-title">
        <div class="site-name">MAPPINGCRIME France</div>
        <div class="site-subtitle">Contribuer à une communauté plus sûre</div>
      </div>
    </div>

    <form id="searchForm" class="search-form">
      <input
        id="searchInput"
        type="text"
        placeholder="Rechercher une ville, une adresse..."
        autocomplete="off"
      />
      <button type="submit" class="btn btn-primary btn-small">ALLER</button>
    </form>

    <div class="topbar-actions">
      <button type="button" id="registerBtn" class="btn btn-secondary btn-small">
        S'inscrire
      </button>
      <button type="button" id="alertsBtn" class="btn btn-primary btn-small">
        Recevoir des alertes
      </button>

      <div class="period-selector">
        <span>Période :</span>
        <select id="periodSelect">
          <option value="7">7 derniers jours</option>
          <option value="30">30 derniers jours</option>
          <option value="365">12 derniers mois</option>
          <option value="all">Tout</option>
        </select>
      </div>
    </div>
  </header>

  <!-- CONTENU PRINCIPAL -->
  <main class="layout">
    <!-- COLONNE GAUCHE : DÉCLARATION CITOYENNE -->
    <aside class="sidebar">
      <section class="declaration-panel">
        <div class="panel-header">
          <h1>Déclaration citoyenne</h1>
        </div>

        <p class="panel-warning">
          Cette plateforme ne remplace pas un dépôt de plainte auprès de la police ou de la
          gendarmerie. En cas d'urgence, appelez le
          <strong>17 / 15 / 18 / 112</strong>.
        </p>

        <form id="reportForm" class="report-form">
          <!-- Type de fait -->
          <label for="type">Type de fait</label>
          <select id="type" name="type" required>
            <option value="">-- Sélectionner --</option>
            <option value="vol">Vol</option>
            <option value="cambriolage">Cambriolage</option>
            <option value="agression">Agression</option>
            <option value="agression_sexuelle">Agression sexuelle</option>
            <option value="viol">Viol</option>
            <option value="meurtre">Meurtre</option>
            <option value="carjacking">Carjacking</option>
            <option value="trafic_stupefiants">Trafic de stupéfiants</option>
            <option value="degradations">Dégradations</option>
            <option value="autre">Autre</option>
          </select>

          <!-- Date / heure -->
          <label for="datetime">Date et heure (approximatives)</label>
          <input
            id="datetime"
            name="datetime"
            type="datetime-local"
            required
          />

          <!-- Adresse pré-remplie par la carte -->
          <label for="address">Adresse (préremplie par la carte, modifiable)</label>
          <input
            id="address"
            name="address"
            type="text"
            placeholder="Cliquez sur la carte pour préremplir l'adresse"
          />

          <label for="postalCode">Code postal</label>
          <input
            id="postalCode"
            name="postalCode"
            type="text"
            inputmode="numeric"
          />

          <label for="city">Ville</label>
          <input
            id="city"
            name="city"
            type="text"
          />

          <!-- Description -->
          <label for="description">
            Description (sans noms/prénoms, ni infos permettant d’identifier quelqu’un)
          </label>
          <textarea
            id="description"
            name="description"
            rows="4"
            placeholder="Envoi de votre déclaration..."
          ></textarea>

          <!-- Bouton suppression du point -->
          <button
            type="button"
            id="removePointBtn"
            class="btn btn-secondary btn-small"
            disabled
          >
            Supprimer le point
          </button>

          <!-- Fichiers -->
          <label for="fileInput" class="file-label">
            Photos / vidéos (optionnel)
          </label>
          <input id="fileInput" name="files" type="file" multiple />

          <!-- Message d’erreur -->
          <p id="formError" class="form-error" aria-live="polite"></p>

          <!-- Bouton envoyer -->
          <button type="submit" class="btn btn-submit">
            Envoyer ma déclaration
          </button>
        </form>
      </section>
    </aside>

    <!-- CARTE -->
    <section class="map-wrapper">
      <div id="map"></div>

      <!-- LÉGENDE -->
      <div class="map-legend">
        <h2>Types de faits</h2>

        <label>
          <input type="checkbox" class="filter-type" data-type="vol" checked />
          <img src="img/vol.png" alt="" />
          <span>Vol</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="cambriolage" checked />
          <img src="img/cambriolage.png" alt="" />
          <span>Cambriolage</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="agression" checked />
          <img src="img/agression.png" alt="" />
          <span>Agression</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="agression_sexuelle" checked />
          <img src="img/Agression_sexuelle.png" alt="" />
          <span>Agression sexuelle</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="viol" checked />
          <img src="img/viol.png" alt="" />
          <span>Viol</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="meurtre" checked />
          <img src="img/meurtre.png" alt="" />
          <span>Meurtre</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="carjacking" checked />
          <img src="img/carjacking.png" alt="" />
          <span>Carjacking</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="trafic_stupefiants" checked />
          <img src="img/trafic_stupefiants.png" alt="" />
          <span>Trafic de stupéfiants</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="degradations" checked />
          <img src="img/degradations.png" alt="" />
          <span>Dégradations</span>
        </label>

        <label>
          <input type="checkbox" class="filter-type" data-type="autre" checked />
          <img src="img/autre.png" alt="" />
          <span>Autre</span>
        </label>
      </div>
    </section>
  </main>

  <!-- Zone cachée pour debug (utilisée par report.js si besoin) -->
  <pre id="debugOutput" class="debug-output" aria-hidden="true"></pre>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/JbEl7kHkB2Jx1Q1rPpWw="
    crossorigin=""
  ></script>

  <!-- Logique de la carte & du formulaire -->
  <script src="js/report.js"></script>
</body>
</html>
